<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø§Ù„Ø°ÙƒÙŠ - Ø®Ø·ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5;
            --secondary-color: #06b6d4;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-success: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .quiz-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .quiz-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            max-width: 700px;
            width: 100%;
            overflow: hidden;
            position: relative;
        }

        .quiz-header {
            background: var(--gradient-primary);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .quiz-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .quiz-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #fff, #f0f0f0);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .quiz-body {
            padding: 40px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .question-container {
            display: none;
            animation: fadeInUp 0.6s ease;
        }

        .question-container.active {
            display: block;
        }

        .question-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 25px;
            text-align: center;
        }

        .question-subtitle {
            font-size: 1rem;
            color: #4a5568;
            margin-bottom: 20px;
            text-align: center;
            opacity: 0.8;
        }

        .options-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }

        .options-grid.two-columns {
            grid-template-columns: 1fr 1fr;
        }

        .options-grid.three-columns {
            grid-template-columns: repeat(3, 1fr);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-card {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .option-card.selected {
            background: var(--gradient-primary);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(79, 70, 229, 0.3);
        }

        .option-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            display: block;
        }

        .option-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .option-description {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .checkbox-group {
            display: grid;
            gap: 10px;
            margin-bottom: 20px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-item:hover {
            border-color: var(--primary-color);
            background: #f1f5f9;
        }

        .checkbox-item.selected {
            background: var(--gradient-primary);
            color: white;
            border-color: var(--primary-color);
        }

        .checkbox-item input[type="checkbox"] {
            margin-left: 10px;
            transform: scale(1.2);
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            position: sticky;
            bottom: 0;
            background: white;
            padding: 20px 0;
        }

        .btn-nav {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-prev {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-prev:hover {
            background: #cbd5e0;
            transform: translateX(-3px);
        }

        .btn-next {
            background: var(--gradient-primary);
            color: white;
            min-width: 120px;
        }

        .btn-next:hover {
            transform: translateX(3px);
            box-shadow: 0 5px 15px rgba(79, 70, 229, 0.4);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .question-number {
            background: var(--gradient-accent);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin: 0 auto 20px;
        }

        .auto-save-indicator {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--success-color);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .auto-save-indicator.show {
            opacity: 1;
        }

        .validation-error {
            color: var(--danger-color);
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }

        .result-container {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .result-container.active {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        .result-icon {
            font-size: 4rem;
            color: var(--success-color);
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 2rem;
            font-weight: 800;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .result-description {
            font-size: 1.1rem;
            color: #4a5568;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .result-details {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: right;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-weight: 600;
            color: #2d3748;
        }

        .result-value {
            font-weight: 700;
            color: var(--primary-color);
        }

        .macro-chart {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .macro-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .macro-percentage {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-color);
        }

        .macro-label {
            font-size: 0.9rem;
            color: #4a5568;
            margin-top: 5px;
        }

        .meal-plan-preview {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: right;
        }

        .meal-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .meal-item:last-child {
            border-bottom: none;
        }

        .meal-name {
            font-weight: 600;
            color: #2d3748;
        }

        .meal-calories {
            background: var(--gradient-accent);
            color: white;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .result-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn-result {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-secondary {
            background: var(--gradient-secondary);
            color: white;
        }

        .btn-success {
            background: var(--gradient-success);
            color: white;
        }

        .btn-result:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            color: white;
            text-decoration: none;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .quiz-card {
                margin: 10px;
                border-radius: 20px;
            }
            
            .quiz-header {
                padding: 20px;
            }
            
            .quiz-title {
                font-size: 1.8rem;
            }
            
            .quiz-body {
                padding: 20px;
            }
            
            .options-grid.two-columns,
            .options-grid.three-columns {
                grid-template-columns: 1fr;
            }
            
            .input-row {
                grid-template-columns: 1fr;
            }
            
            .macro-chart {
                grid-template-columns: 1fr;
            }
            
            .result-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <div class="quiz-card">
            <div class="auto-save-indicator" id="autoSaveIndicator">
                <i class="fas fa-save"></i> ØªÙ… Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            </div>
            
            <div class="quiz-header">
                <h1 class="quiz-title">ğŸ¯ Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø§Ù„Ø°ÙƒÙŠ</h1>
                <p class="quiz-subtitle">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®Ø·Ø© ØªØºØ°ÙŠØ© ÙˆØªÙ…Ø§Ø±ÙŠÙ† Ù…Ø®ØµØµØ© ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ùƒ</p>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
            </div>

            <div class="quiz-body">
                <!-- Question 1: Basic Personal Data -->
                <div class="question-container active" data-question="1">
                    <div class="question-number">1</div>
                    <h2 class="question-title">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
                    <p class="question-subtitle">Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¶Ø±ÙˆØ±ÙŠØ© Ù„Ø­Ø³Ø§Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© Ø¨Ø¯Ù‚Ø©</p>
                    
                    <div class="input-group">
                        <label>Ø§Ù„Ø¹Ù…Ø± (Ø³Ù†Ø©)</label>
                        <input type="number" id="age" min="13" max="80" placeholder="Ù…Ø«Ø§Ù„: 25" required>
                        <div class="validation-error" id="ageError">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù…Ø± ØµØ­ÙŠØ­ (13-80 Ø³Ù†Ø©)</div>
                    </div>
                    
                    <div class="input-row">
                        <div class="input-group">
                            <label>Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ (ÙƒÙŠÙ„Ùˆ)</label>
                            <input type="number" id="currentWeight" min="30" max="200" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 70.5" required>
                            <div class="validation-error" id="weightError">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ²Ù† ØµØ­ÙŠØ­ (30-200 ÙƒÙŠÙ„Ùˆ)</div>
                        </div>
                        <div class="input-group">
                            <label>Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)</label>
                            <input type="number" id="height" min="120" max="220" placeholder="Ù…Ø«Ø§Ù„: 170" required>
                            <div class="validation-error" id="heightError">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø·ÙˆÙ„ ØµØ­ÙŠØ­ (120-220 Ø³Ù…)</div>
                        </div>
                    </div>
                    
                    <div class="input-row">
                        <div class="input-group">
                            <label>Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù (ÙƒÙŠÙ„Ùˆ)</label>
                            <input type="number" id="targetWeight" min="30" max="200" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 65" required>
                            <div class="validation-error" id="targetWeightError">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ²Ù† Ù…Ø³ØªÙ‡Ø¯Ù ØµØ­ÙŠØ­</div>
                        </div>
                        <div class="input-group">
                            <label>Ø§Ù„Ø¬Ù†Ø³</label>
                            <select id="gender" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³</option>
                                <option value="male">Ø°ÙƒØ±</option>
                                <option value="female">Ø£Ù†Ø«Ù‰</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Ø³Ø±Ø¹Ø© ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø±ØºÙˆØ¨Ø©</label>
                        <div class="options-grid three-columns">
                            <div class="option-card" data-value="fast">
                                <i class="fas fa-rocket option-icon"></i>
                                <div class="option-title">Ø³Ø±ÙŠØ¹</div>
                                <div class="option-description">1-1.5 ÙƒÙŠÙ„Ùˆ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹</div>
                            </div>
                            <div class="option-card" data-value="moderate">
                                <i class="fas fa-walking option-icon"></i>
                                <div class="option-title">Ù…ØªÙˆØ³Ø·</div>
                                <div class="option-description">0.5-1 ÙƒÙŠÙ„Ùˆ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹</div>
                            </div>
                            <div class="option-card" data-value="slow">
                                <i class="fas fa-turtle option-icon"></i>
                                <div class="option-title">Ø¨Ø·ÙŠØ¡</div>
                                <div class="option-description">0.25-0.5 ÙƒÙŠÙ„Ùˆ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-nav btn-prev" onclick="previousQuestion()" disabled>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <button class="btn-nav btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    </div>
                </div>

                <!-- Question 2: Daily Activity Level -->
                <div class="question-container" data-question="2">
                    <div class="question-number">2</div>
                    <h2 class="question-title">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
                    <p class="question-subtitle">ÙŠØ³Ø§Ø¹Ø¯Ù†Ø§ Ù‡Ø°Ø§ ÙÙŠ Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø£ÙŠØ¶ Ø§Ù„ÙƒÙ„ÙŠ (TDEE) Ø¨Ø¯Ù‚Ø©</p>
                    
                    <div class="options-grid">
                        <div class="option-card" data-value="sedentary">
                            <i class="fas fa-couch option-icon"></i>
                            <div class="option-title">Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©</div>
                            <div class="option-description">Ø¹Ù…Ù„ Ù…ÙƒØªØ¨ÙŠØŒ Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ…Ø§Ø±ÙŠÙ† Ø£Ùˆ ØªÙ…Ø§Ø±ÙŠÙ† Ù‚Ù„ÙŠÙ„Ø© Ø¬Ø¯Ø§Ù‹</div>
                        </div>
                        <div class="option-card" data-value="light">
                            <i class="fas fa-walking option-icon"></i>
                            <div class="option-title">Ù†Ø´Ø§Ø· Ø®ÙÙŠÙ</div>
                            <div class="option-description">ØªÙ…Ø§Ø±ÙŠÙ† Ø®ÙÙŠÙØ© Ø£Ùˆ Ø±ÙŠØ§Ø¶Ø© 1-3 Ø£ÙŠØ§Ù… ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                        </div>
                        <div class="option-card" data-value="moderate">
                            <i class="fas fa-running option-icon"></i>
                            <div class="option-title">Ù†Ø´Ø§Ø· Ù…ØªÙˆØ³Ø·</div>
                            <div class="option-description">ØªÙ…Ø§Ø±ÙŠÙ† Ù…ØªÙˆØ³Ø·Ø© 3-5 Ø£ÙŠØ§Ù… ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                        </div>
                        <div class="option-card" data-value="active">
                            <i class="fas fa-dumbbell option-icon"></i>
                            <div class="option-title">Ù†Ø´ÙŠØ· Ø¬Ø¯Ø§Ù‹</div>
                            <div class="option-description">ØªÙ…Ø§Ø±ÙŠÙ† Ù…ÙƒØ«ÙØ© 6-7 Ø£ÙŠØ§Ù… ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                        </div>
                        <div class="option-card" data-value="very_active">
                            <i class="fas fa-fire option-icon"></i>
                            <div class="option-title">Ù†Ø´ÙŠØ· Ù„Ù„ØºØ§ÙŠØ©</div>
                            <div class="option-description">ØªÙ…Ø§Ø±ÙŠÙ† Ù…ÙƒØ«ÙØ© ÙŠÙˆÙ…ÙŠØ§Ù‹ + Ø¹Ù…Ù„ Ø¨Ø¯Ù†ÙŠ Ø´Ø§Ù‚</div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-nav btn-prev" onclick="previousQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <button class="btn-nav btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    </div>
                </div>

                <!-- Question 3: Food Preferences & Restrictions -->
                <div class="question-container" data-question="3">
                    <div class="question-number">3</div>
                    <h2 class="question-title">Ø§Ù„ØªÙØ¶ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ù‚ÙŠÙˆØ¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</h2>
                    <p class="question-subtitle">Ø³Ù†Ø®ØµØµ Ø®Ø·Ø© Ø§Ù„ØªØºØ°ÙŠØ© ÙˆÙÙ‚Ø§Ù‹ Ù„ØªÙØ¶ÙŠÙ„Ø§ØªÙƒ ÙˆÙ‚ÙŠÙˆØ¯Ùƒ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</p>
                    
                    <div class="input-group">
                        <label>Ù†ÙˆØ¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØºØ°Ø§Ø¦ÙŠ</label>
                        <div class="options-grid two-columns">
                            <div class="option-card" data-value="omnivore">
                                <i class="fas fa-utensils option-icon"></i>
                                <div class="option-title">Ù…ØªÙ†ÙˆØ¹</div>
                                <div class="option-description">Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù…</div>
                            </div>
                            <div class="option-card" data-value="vegetarian">
                                <i class="fas fa-leaf option-icon"></i>
                                <div class="option-title">Ù†Ø¨Ø§ØªÙŠ</div>
                                <div class="option-description">Ù„Ø§ Ù„Ø­ÙˆÙ…ØŒ Ù†Ø¹Ù… Ù„Ù„Ø¨ÙŠØ¶ ÙˆÙ…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£Ù„Ø¨Ø§Ù†</div>
                            </div>
                            <div class="option-card" data-value="vegan">
                                <i class="fas fa-seedling option-icon"></i>
                                <div class="option-title">Ù†Ø¨Ø§ØªÙŠ ØµØ±Ù</div>
                                <div class="option-description">Ù†Ø¨Ø§ØªØ§Øª ÙÙ‚Ø·ØŒ Ù„Ø§ Ù…Ù†ØªØ¬Ø§Øª Ø­ÙŠÙˆØ§Ù†ÙŠØ©</div>
                            </div>
                            <div class="option-card" data-value="pescatarian">
                                <i class="fas fa-fish option-icon"></i>
                                <div class="option-title">Ø³Ù…ÙƒÙŠ</div>
                                <div class="option-description">Ø£Ø³Ù…Ø§Ùƒ ÙˆÙ†Ø¨Ø§ØªØ§ØªØŒ Ù„Ø§ Ù„Ø­ÙˆÙ…</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© (Ø§Ø®ØªØ± ÙƒÙ„ Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item" data-allergy="lactose">
                                <input type="checkbox" id="lactose">
                                <label for="lactose">Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù„Ø§ÙƒØªÙˆØ² (Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£Ù„Ø¨Ø§Ù†)</label>
                            </div>
                            <div class="checkbox-item" data-allergy="gluten">
                                <input type="checkbox" id="gluten">
                                <label for="gluten">Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ø¬Ù„ÙˆØªÙŠÙ† (Ø§Ù„Ù‚Ù…Ø­)</label>
                            </div>
                            <div class="checkbox-item" data-allergy="nuts">
                                <input type="checkbox" id="nuts">
                                <label for="nuts">Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</label>
                            </div>
                            <div class="checkbox-item" data-allergy="eggs">
                                <input type="checkbox" id="eggs">
                                <label for="eggs">Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ø¨ÙŠØ¶</label>
                            </div>
                            <div class="checkbox-item" data-allergy="seafood">
                                <input type="checkbox" id="seafood">
                                <label for="seafood">Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø§Ù„Ø¨Ø­Ø±ÙŠØ©</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Ø§Ù„Ù…Ø·Ø¨Ø® Ø§Ù„Ù…ÙØ¶Ù„</label>
                        <div class="options-grid three-columns">
                            <div class="option-card" data-value="mediterranean">
                                <i class="fas fa-olive-branch option-icon"></i>
                                <div class="option-title">Ù…ØªÙˆØ³Ø·ÙŠ</div>
                            </div>
                            <div class="option-card" data-value="middle_eastern">
                                <i class="fas fa-mosque option-icon"></i>
                                <div class="option-title">Ø´Ø±Ù‚ Ø£ÙˆØ³Ø·ÙŠ</div>
                            </div>
                            <div class="option-card" data-value="asian">
                                <i class="fas fa-yin-yang option-icon"></i>
                                <div class="option-title">Ø¢Ø³ÙŠÙˆÙŠ</div>
                            </div>
                            <div class="option-card" data-value="international">
                                <i class="fas fa-globe option-icon"></i>
                                <div class="option-title">Ø¹Ø§Ù„Ù…ÙŠ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-nav btn-prev" onclick="previousQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <button class="btn-nav btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    </div>
                </div>

                <!-- Question 4: Budget & Time Availability -->
                <div class="question-container" data-question="4">
                    <div class="question-number">4</div>
                    <h2 class="question-title">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ§Ø­</h2>
                    <p class="question-subtitle">Ø³Ù†Ù‚ØªØ±Ø­ ÙˆØ¬Ø¨Ø§Øª ØªÙ†Ø§Ø³Ø¨ Ù…ÙŠØ²Ø§Ù†ÙŠØªÙƒ ÙˆÙˆÙ‚ØªÙƒ Ø§Ù„Ù…ØªØ§Ø­ Ù„Ù„Ø·Ø¨Ø®</p>
                    
                    <div class="input-group">
                        <label>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù„Ø·Ø¹Ø§Ù…</label>
                        <div class="options-grid three-columns">
                            <div class="option-card" data-value="low">
                                <i class="fas fa-coins option-icon"></i>
                                <div class="option-title">Ù…Ø­Ø¯ÙˆØ¯Ø©</div>
                                <div class="option-description">Ø£Ù‚Ù„ Ù…Ù† 500 Ø±ÙŠØ§Ù„</div>
                            </div>
                            <div class="option-card" data-value="medium">
                                <i class="fas fa-money-bill option-icon"></i>
                                <div class="option-title">Ù…ØªÙˆØ³Ø·Ø©</div>
                                <div class="option-description">500-1000 Ø±ÙŠØ§Ù„</div>
                            </div>
                            <div class="option-card" data-value="high">
                                <i class="fas fa-money-bill-wave option-icon"></i>
                                <div class="option-title">Ù…Ø±ØªÙØ¹Ø©</div>
                                <div class="option-description">Ø£ÙƒØ«Ø± Ù…Ù† 1000 Ø±ÙŠØ§Ù„</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ§Ø­ Ù„Ù„Ø·Ø¨Ø® ÙŠÙˆÙ…ÙŠØ§Ù‹</label>
                        <div class="options-grid">
                            <div class="option-card" data-value="quick">
                                <i class="fas fa-clock option-icon"></i>
                                <div class="option-title">ÙˆØ¬Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©</div>
                                <div class="option-description">Ø£Ù‚Ù„ Ù…Ù† 15 Ø¯Ù‚ÙŠÙ‚Ø© - ÙˆØ¬Ø¨Ø§Øª Ø¬Ø§Ù‡Ø²Ø© ÙˆØ³Ù‡Ù„Ø©</div>
                            </div>
                            <div class="option-card" data-value="moderate">
                                <i class="fas fa-stopwatch option-icon"></i>
                                <div class="option-title">Ø·Ø¨Ø® Ù…ØªÙˆØ³Ø·</div>
                                <div class="option-description">15-30 Ø¯Ù‚ÙŠÙ‚Ø© - ÙˆØ¬Ø¨Ø§Øª Ø¨Ø³ÙŠØ·Ø©</div>
                            </div>
                            <div class="option-card" data-value="full">
                                <i class="fas fa-hourglass-half option-icon"></i>
                                <div class="option-title">Ø·Ø¨Ø® ÙƒØ§Ù…Ù„</div>
                                <div class="option-description">Ø£ÙƒØ«Ø± Ù…Ù† 30 Ø¯Ù‚ÙŠÙ‚Ø© - ÙˆØ¬Ø¨Ø§Øª Ù…ÙØµÙ„Ø©</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-nav btn-prev" onclick="previousQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <button class="btn-nav btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    </div>
                </div>

                <!-- Question 5: Health Conditions -->
                <div class="question-container" data-question="5">
                    <div class="question-number">5</div>
                    <h2 class="question-title">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ© ÙˆØ§Ù„Ù…ÙƒÙ…Ù„Ø§Øª</h2>
                    <p class="question-subtitle">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù‡Ù…Ø© Ù„Ø¶Ù…Ø§Ù† Ø³Ù„Ø§Ù…Ø© ÙˆÙØ¹Ø§Ù„ÙŠØ© Ø®Ø·ØªÙƒ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</p>
                    
                    <div class="input-group">
                        <label>Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØµØ­ÙŠØ© Ø§Ù„Ù…Ø²Ù…Ù†Ø© (Ø§Ø®ØªØ± ÙƒÙ„ Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item" data-condition="none">
                                <input type="checkbox" id="none">
                                <label for="none">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø§Ù„Ø§Øª ØµØ­ÙŠØ© Ù…Ø²Ù…Ù†Ø©</label>
                            </div>
                            <div class="checkbox-item" data-condition="diabetes">
                                <input type="checkbox" id="diabetes">
                                <label for="diabetes">Ø§Ù„Ø³ÙƒØ±ÙŠ</label>
                            </div>
                            <div class="checkbox-item" data-condition="hypertension">
                                <input type="checkbox" id="hypertension">
                                <label for="hypertension">Ø¶ØºØ· Ø§Ù„Ø¯Ù… Ø§Ù„Ù…Ø±ØªÙØ¹</label>
                            </div>
                            <div class="checkbox-item" data-condition="heart">
                                <input type="checkbox" id="heart">
                                <label for="heart">Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨</label>
                            </div>
                            <div class="checkbox-item" data-condition="thyroid">
                                <input type="checkbox" id="thyroid">
                                <label for="thyroid">Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØºØ¯Ø© Ø§Ù„Ø¯Ø±Ù‚ÙŠØ©</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Ø§Ù„Ù…ÙƒÙ…Ù„Ø§Øª Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item" data-supplement="none">
                                <input type="checkbox" id="no_supplements">
                                <label for="no_supplements">Ù„Ø§ Ø£Ø³ØªØ®Ø¯Ù… Ù…ÙƒÙ…Ù„Ø§Øª</label>
                            </div>
                            <div class="checkbox-item" data-supplement="whey">
                                <input type="checkbox" id="whey">
                                <label for="whey">Ø¨Ø±ÙˆØªÙŠÙ† Ù…ØµÙ„ Ø§Ù„Ù„Ø¨Ù† (Whey)</label>
                            </div>
                            <div class="checkbox-item" data-supplement="creatine">
                                <input type="checkbox" id="creatine">
                                <label for="creatine">Ø§Ù„ÙƒØ±ÙŠØ§ØªÙŠÙ†</label>
                            </div>
                            <div class="checkbox-item" data-supplement="vitamins">
                                <input type="checkbox" id="vitamins">
                                <label for="vitamins">ÙÙŠØªØ§Ù…ÙŠÙ†Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©</label>
                            </div>
                            <div class="checkbox-item" data-supplement="omega3">
                                <input type="checkbox" id="omega3">
                                <label for="omega3">Ø£ÙˆÙ…ÙŠØ¬Ø§ 3</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-nav btn-prev" onclick="previousQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <button class="btn-nav btn-next" onclick="nextQuestion()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    </div>
                </div>

                <!-- Question 6: Primary Goal -->
                <div class="question-container" data-question="6">
                    <div class="question-number">6</div>
                    <h2 class="question-title">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</h2>
                    <p class="question-subtitle">Ø³ÙŠØ­Ø¯Ø¯ Ù‡Ø°Ø§ Ù†ÙˆØ¹ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† ÙˆØ§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØºØ°Ø§Ø¦ÙŠ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ</p>
                    
                    <div class="options-grid">
                        <div class="option-card" data-value="weight_loss">
                            <i class="fas fa-weight option-icon"></i>
                            <div class="option-title">Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†</div>
                            <div class="option-description">Ø­Ø±Ù‚ Ø§Ù„Ø¯Ù‡ÙˆÙ† ÙˆØ§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ</div>
                        </div>
                        <div class="option-card" data-value="muscle_gain">
                            <i class="fas fa-dumbbell option-icon"></i>
                            <div class="option-title">Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ø¶Ù„Ø§Øª</div>
                            <div class="option-description">Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙƒØªÙ„Ø© Ø§Ù„Ø¹Ø¶Ù„ÙŠØ© ÙˆØ§Ù„Ù‚ÙˆØ©</div>
                        </div>
                        <div class="option-card" data-value="fitness">
                            <i class="fas fa-heart option-icon"></i>
                            <div class="option-title">ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù„ÙŠØ§Ù‚Ø©</div>
                            <div class="option-description">Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ù…Ù„ ÙˆØ§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø©</div>
                        </div>
                        <div class="option-card" data-value="maintenance">
                            <i class="fas fa-balance-scale option-icon"></i>
                            <div class="option-title">Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                            <div class="option-description">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ²Ù† ÙˆØ§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn-nav btn-prev" onclick="previousQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <button class="btn-nav btn-next" onclick="showResults()">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®Ø·ØªÙƒ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© ğŸ¯</button>
                    </div>
                </div>

                <!-- Results -->
                <div class="result-container" id="results">
                    <i class="fas fa-trophy result-icon"></i>
                    <h2 class="result-title">Ø®Ø·ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø¬Ø§Ù‡Ø²Ø©! ğŸ‰</h2>
                    <p class="result-description">
                        ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø¯Ù‚Ø© ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ù…Ø®ØµØµØ© ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ ÙˆØ£Ù‡Ø¯Ø§ÙÙƒ.
                    </p>
                    
                    <div class="result-details" id="calculationResults">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù‡Ù†Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                    </div>
                    
                    <div class="macro-chart" id="macroChart">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø§ÙƒØ±ÙˆØ² Ù‡Ù†Ø§ -->
                    </div>
                    
                    <div class="meal-plan-preview" id="mealPlanPreview">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø®Ø·Ø© Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ù‡Ù†Ø§ -->
                    </div>
                    
                    <div class="result-actions">
                        <button class="btn-result btn-primary" onclick="viewMealPlan()">
                            <i class="fas fa-utensils"></i> Ø¹Ø±Ø¶ Ø®Ø·Ø© Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©
                        </button>

                        <a href="/workout-plans" class="btn-result btn-secondary">
                            <i class="fas fa-dumbbell"></i> Ø®Ø·Ø© Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†
                        </a>
                        <a href="/calculators" class="btn-result btn-success">
                            <i class="fas fa-calculator"></i> Ø­Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ù„ÙŠØ§Ù‚Ø©
                        </a>
                        <button class="btn-result btn-info" onclick="downloadPlan()">
                            <i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø·Ø© PDF
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = 1;
        const totalQuestions = 6;
        let answers = {};
        let autoSaveTimer;

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedData();
            setupEventListeners();
            updateProgress();
            validateCurrentQuestion();
        });

        function setupEventListeners() {
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø¬Ù…ÙŠØ¹ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            const optionCards = document.querySelectorAll('.option-card');
            optionCards.forEach(card => {
                card.addEventListener('click', function() {
                    const questionNum = this.closest('.question-container').dataset.question;
                    const value = this.getAttribute('data-value');
                    selectOption(this, value, questionNum);
                });
            });

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†ØµÙŠØ©
            const inputs = document.querySelectorAll('input, select');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    validateInput(this);
                    autoSave();
                    validateCurrentQuestion();
                });
            });

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
            const checkboxItems = document.querySelectorAll('.checkbox-item');
            checkboxItems.forEach(item => {
                item.addEventListener('click', function() {
                    const checkbox = this.querySelector('input[type="checkbox"]');
                    checkbox.checked = !checkbox.checked;
                    this.classList.toggle('selected', checkbox.checked);
                    
                    // Ø¥Ø°Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± "Ù„Ø§ ØªÙˆØ¬Ø¯" ÙÙ‚Ù… Ø¨Ø¥Ù„ØºØ§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¨Ø§Ù‚ÙŠ
                    if (checkbox.id === 'none' || checkbox.id === 'no_supplements') {
                        if (checkbox.checked) {
                            const otherCheckboxes = this.parentElement.querySelectorAll('input[type="checkbox"]:not(#' + checkbox.id + ')');
                            otherCheckboxes.forEach(cb => {
                                cb.checked = false;
                                cb.closest('.checkbox-item').classList.remove('selected');
                            });
                        }
                    } else {
                        // Ø¥Ø°Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø®ÙŠØ§Ø± Ø¢Ø®Ø±ØŒ Ù‚Ù… Ø¨Ø¥Ù„ØºØ§Ø¡ ØªØ­Ø¯ÙŠØ¯ "Ù„Ø§ ØªÙˆØ¬Ø¯"
                        const noneCheckbox = this.parentElement.querySelector('#none, #no_supplements');
                        if (noneCheckbox && noneCheckbox.checked) {
                            noneCheckbox.checked = false;
                            noneCheckbox.closest('.checkbox-item').classList.remove('selected');
                        }
                    }
                    
                    autoSave();
                    validateCurrentQuestion();
                });
            });
        }

        function validateInput(input) {
            const value = parseFloat(input.value);
            const min = parseFloat(input.min);
            const max = parseFloat(input.max);
            const errorElement = document.getElementById(input.id + 'Error');
            
            let isValid = true;
            
            if (input.type === 'number') {
                if (isNaN(value) || value < min || value > max) {
                    isValid = false;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù
                if (input.id === 'targetWeight') {
                    const currentWeight = parseFloat(document.getElementById('currentWeight').value);
                    if (!isNaN(currentWeight) && Math.abs(value - currentWeight) > 50) {
                        isValid = false;
                        errorElement.textContent = 'Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØ§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹';
                    }
                }
            }
            
            if (errorElement) {
                errorElement.style.display = isValid ? 'none' : 'block';
            }
            
            input.style.borderColor = isValid ? '#e2e8f0' : '#ef4444';
            
            return isValid;
        }

        function validateCurrentQuestion() {
            const currentContainer = document.querySelector(`[data-question="${currentQuestion}"]`);
            const nextBtn = currentContainer.querySelector('.btn-next');
            let isValid = true;
            
            if (currentQuestion === 1) {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ÙˆÙ„
                const requiredInputs = ['age', 'currentWeight', 'height', 'targetWeight', 'gender'];
                for (let inputId of requiredInputs) {
                    const input = document.getElementById(inputId);
                    if (!input.value || (input.type === 'number' && !validateInput(input))) {
                        isValid = false;
                        break;
                    }
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø³Ø±Ø¹Ø© ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ²Ù†
                const weightChangeSpeed = currentContainer.querySelector('.option-card.selected');
                if (!weightChangeSpeed) {
                    isValid = false;
                }
            } else {
                // Ù„Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£Ø®Ø±Ù‰ØŒ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø®ØªÙŠØ§Ø±
                const selectedOption = currentContainer.querySelector('.option-card.selected');
                if (!selectedOption) {
                    isValid = false;
                }
            }
            
            nextBtn.disabled = !isValid;
        }

        function selectOption(element, value, questionNum) {
            const currentContainer = document.querySelector(`[data-question="${questionNum}"]`);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
            const options = currentContainer.querySelectorAll('.option-card');
            options.forEach(option => option.classList.remove('selected'));
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ù„Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ù…Ù†Ù‚ÙˆØ±
            element.classList.add('selected');
            
            // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            answers[`question_${questionNum}`] = value;
            
            // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ
            validateCurrentQuestion();
            autoSave();
        }

        function updateProgress() {
            const progress = (currentQuestion - 1) / totalQuestions * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function nextQuestion() {
            if (currentQuestion === 1) {
                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                answers.age = parseInt(document.getElementById('age').value);
                answers.currentWeight = parseFloat(document.getElementById('currentWeight').value);
                answers.height = parseInt(document.getElementById('height').value);
                answers.targetWeight = parseFloat(document.getElementById('targetWeight').value);
                answers.gender = document.getElementById('gender').value;
            } else if (currentQuestion === 3) {
                // Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©
                answers.allergies = [];
                document.querySelectorAll('[data-question="3"] .checkbox-item.selected').forEach(item => {
                    answers.allergies.push(item.dataset.allergy);
                });
            } else if (currentQuestion === 5) {
                // Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØµØ­ÙŠØ© ÙˆØ§Ù„Ù…ÙƒÙ…Ù„Ø§Øª
                answers.healthConditions = [];
                answers.supplements = [];
                
                document.querySelectorAll('[data-question="5"] .checkbox-item.selected').forEach(item => {
                    if (item.dataset.condition) {
                        answers.healthConditions.push(item.dataset.condition);
                    }
                    if (item.dataset.supplement) {
                        answers.supplements.push(item.dataset.supplement);
                    }
                });
            }
            
            if (currentQuestion < totalQuestions) {
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.remove('active');
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ
                currentQuestion++;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('active');
                
                updateProgress();
                validateCurrentQuestion();
                autoSave();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 1) {
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.remove('active');
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚
                currentQuestion--;
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('active');
                
                updateProgress();
                validateCurrentQuestion();
            }
        }

        function autoSave() {
            clearTimeout(autoSaveTimer);
            autoSaveTimer = setTimeout(() => {
                localStorage.setItem('quizAnswers', JSON.stringify(answers));
                localStorage.setItem('currentQuestion', currentQuestion);
                showAutoSaveIndicator();
            }, 1000);
        }

        function loadSavedData() {
            const savedAnswers = localStorage.getItem('quizAnswers');
            const savedQuestion = localStorage.getItem('currentQuestion');
            
            if (savedAnswers) {
                answers = JSON.parse(savedAnswers);
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
                if (answers.age) document.getElementById('age').value = answers.age;
                if (answers.currentWeight) document.getElementById('currentWeight').value = answers.currentWeight;
                if (answers.height) document.getElementById('height').value = answers.height;
                if (answers.targetWeight) document.getElementById('targetWeight').value = answers.targetWeight;
                if (answers.gender) document.getElementById('gender').value = answers.gender;
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
                Object.keys(answers).forEach(key => {
                    if (key.startsWith('question_')) {
                        const questionNum = key.split('_')[1];
                        const value = answers[key];
                        const optionCard = document.querySelector(`[data-question="${questionNum}"] [data-value="${value}"]`);
                        if (optionCard) {
                            optionCard.classList.add('selected');
                        }
                    }
                });
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØµØ­ÙŠØ©
                if (answers.allergies) {
                    answers.allergies.forEach(allergy => {
                        const item = document.querySelector(`[data-allergy="${allergy}"]`);
                        if (item) {
                            item.classList.add('selected');
                            item.querySelector('input').checked = true;
                        }
                    });
                }
                
                if (answers.healthConditions) {
                    answers.healthConditions.forEach(condition => {
                        const item = document.querySelector(`[data-condition="${condition}"]`);
                        if (item) {
                            item.classList.add('selected');
                            item.querySelector('input').checked = true;
                        }
                    });
                }
                
                if (answers.supplements) {
                    answers.supplements.forEach(supplement => {
                        const item = document.querySelector(`[data-supplement="${supplement}"]`);
                        if (item) {
                            item.classList.add('selected');
                            item.querySelector('input').checked = true;
                        }
                    });
                }
            }
            
            if (savedQuestion && parseInt(savedQuestion) > 1) {
                currentQuestion = parseInt(savedQuestion);
                document.querySelector('[data-question="1"]').classList.remove('active');
                document.querySelector(`[data-question="${currentQuestion}"]`).classList.add('active');
                updateProgress();
            }
        }

        function showAutoSaveIndicator() {
            const indicator = document.getElementById('autoSaveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        function calculateBMR(weight, height, age, gender) {
            // Ù…Ø¹Ø§Ø¯Ù„Ø© Mifflin-St Jeor
            if (gender === 'male') {
                return 10 * weight + 6.25 * height - 5 * age + 5;
            } else {
                return 10 * weight + 6.25 * height - 5 * age - 161;
            }
        }

        function calculateTDEE(bmr, activityLevel) {
            const activityFactors = {
                'sedentary': 1.2,
                'light': 1.375,
                'moderate': 1.55,
                'active': 1.725,
                'very_active': 1.9
            };
            
            return bmr * (activityFactors[activityLevel] || 1.2);
        }

        function calculateCalorieGoal(tdee, goal, weightChangeSpeed) {
            const speedFactors = {
                'fast': 700,
                'moderate': 500,
                'slow': 300
            };
            
            const deficit = speedFactors[weightChangeSpeed] || 500;
            
            if (goal === 'weight_loss') {
                return tdee - deficit;
            } else if (goal === 'muscle_gain') {
                return tdee + (deficit * 0.7); // Ø²ÙŠØ§Ø¯Ø© Ø£Ù‚Ù„ Ù„Ù„Ø¨Ù†Ø§Ø¡
            } else {
                return tdee; // Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ²Ù†
            }
        }

        function calculateMacros(calories, goal) {
            let protein, carbs, fats;
            
            if (goal === 'weight_loss') {
                protein = Math.round(calories * 0.30 / 4); // 30% Ø¨Ø±ÙˆØªÙŠÙ†
                fats = Math.round(calories * 0.25 / 9); // 25% Ø¯Ù‡ÙˆÙ†
                carbs = Math.round((calories - (protein * 4) - (fats * 9)) / 4); // Ø§Ù„Ø¨Ø§Ù‚ÙŠ ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª
            } else if (goal === 'muscle_gain') {
                protein = Math.round(calories * 0.25 / 4); // 25% Ø¨Ø±ÙˆØªÙŠÙ†
                fats = Math.round(calories * 0.25 / 9); // 25% Ø¯Ù‡ÙˆÙ†
                carbs = Math.round((calories - (protein * 4) - (fats * 9)) / 4); // 50% ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª
            } else {
                protein = Math.round(calories * 0.20 / 4); // 20% Ø¨Ø±ÙˆØªÙŠÙ†
                fats = Math.round(calories * 0.30 / 9); // 30% Ø¯Ù‡ÙˆÙ†
                carbs = Math.round((calories - (protein * 4) - (fats * 9)) / 4); // 50% ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª
            }
            
            return { protein, carbs, fats };
        }

        function generateMealPlan(calories, macros, dietType, allergies, cuisine, cookingTime) {
            // Ø®Ø·Ø© ÙˆØ¬Ø¨Ø§Øª Ù…Ø¨Ø³Ø·Ø© - ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø³ØªÙƒÙˆÙ† Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const meals = {
                breakfast: { name: 'Ø¥ÙØ·Ø§Ø± ØµØ­ÙŠ', calories: Math.round(calories * 0.25) },
                lunch: { name: 'ØºØ¯Ø§Ø¡ Ù…ØªÙˆØ§Ø²Ù†', calories: Math.round(calories * 0.35) },
                dinner: { name: 'Ø¹Ø´Ø§Ø¡ Ø®ÙÙŠÙ', calories: Math.round(calories * 0.25) },
                snack1: { name: 'ÙˆØ¬Ø¨Ø© Ø®ÙÙŠÙØ© 1', calories: Math.round(calories * 0.08) },
                snack2: { name: 'ÙˆØ¬Ø¨Ø© Ø®ÙÙŠÙØ© 2', calories: Math.round(calories * 0.07) }
            };
            
            // ØªØ®ØµÙŠØµ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ù…ØµØ±ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ØºØ°Ø§Ø¦ÙŠ
            if (dietType === 'vegetarian') {
                meals.breakfast.name = 'ÙÙˆÙ„ Ù…Ø¯Ù…Ø³ Ø¨Ø§Ù„Ø·Ø­ÙŠÙ†Ø© ÙˆØ§Ù„Ø³Ù„Ø·Ø©';
                meals.lunch.name = 'ÙƒØ´Ø±ÙŠ Ù…ØµØ±ÙŠ Ø¨Ø§Ù„Ø¹Ø¯Ø³ ÙˆØ§Ù„Ø£Ø±Ø²';
                meals.dinner.name = 'Ù…Ù„ÙˆØ®ÙŠØ© Ø¨Ø§Ù„Ø®Ø¶Ø§Ø± Ù…Ø¹ Ø§Ù„Ø£Ø±Ø² Ø§Ù„Ø£Ø¨ÙŠØ¶';
                meals.snack1.name = 'Ø·Ø­ÙŠÙ†Ø© Ø¨Ø§Ù„Ø¹Ø³Ù„ Ù…Ø¹ Ø§Ù„Ø®Ø¨Ø² Ø§Ù„Ø¨Ù„Ø¯ÙŠ';
                meals.snack2.name = 'Ø¬Ø¨Ù†Ø© Ù‚Ø±ÙŠØ´ Ù…Ø¹ Ø§Ù„Ø·Ù…Ø§Ø·Ù… ÙˆØ§Ù„Ø®ÙŠØ§Ø±';
            } else if (dietType === 'vegan') {
                meals.breakfast.name = 'Ø¹ØµÙŠØ± Ù‚ØµØ¨ Ø·Ø¨ÙŠØ¹ÙŠ Ù…Ø¹ Ø§Ù„ØªÙ…Ø±';
                meals.lunch.name = 'ÙØ§ØµÙˆÙ„ÙŠØ§ Ø®Ø¶Ø±Ø§Ø¡ Ø¨Ø§Ù„Ø·Ù…Ø§Ø·Ù… ÙˆØ§Ù„Ø£Ø±Ø²';
                meals.dinner.name = 'Ø´ÙˆØ±Ø¨Ø© Ø¹Ø¯Ø³ Ù…ØµØ±ÙŠØ© Ù…Ø¹ Ø§Ù„Ø®Ø¨Ø² Ø§Ù„Ø¨Ù„Ø¯ÙŠ';
                meals.snack1.name = 'Ø­Ù…Øµ Ø¨Ø§Ù„Ø·Ø­ÙŠÙ†Ø© ÙˆØ§Ù„Ù„ÙŠÙ…ÙˆÙ†';
                meals.snack2.name = 'ÙÙˆØ§ÙƒÙ‡ Ù…ÙˆØ³Ù…ÙŠØ© (Ø¨Ø±ØªÙ‚Ø§Ù„ ÙˆÙ…ÙˆØ²)';
            } else {
                meals.breakfast.name = 'Ø¹ÙŠØ´ Ø¨Ù„Ø¯ÙŠ Ø¨Ø§Ù„Ø¬Ø¨Ù†Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ ÙˆØ§Ù„Ø·Ø­ÙŠÙ†Ø©';
                meals.lunch.name = 'ÙØ±Ø§Ø® Ù…Ø´ÙˆÙŠØ© Ù…Ø¹ Ø§Ù„Ø£Ø±Ø² Ø§Ù„Ø£Ø¨ÙŠØ¶ ÙˆØ§Ù„Ø³Ù„Ø·Ø©';
                meals.dinner.name = 'Ø³Ù…Ùƒ Ø¨Ù„Ø·ÙŠ Ù…Ø´ÙˆÙŠ Ù…Ø¹ Ø§Ù„Ø®Ø¶Ø§Ø± Ø§Ù„Ø³ÙˆØªÙŠÙ‡';
                meals.snack1.name = 'Ø²Ø¨Ø§Ø¯ÙŠ Ø¨Ø§Ù„Ø®ÙŠØ§Ø± ÙˆØ§Ù„Ù†Ø¹Ù†Ø§Ø¹';
                meals.snack2.name = 'Ø¨ÙŠØ¶ Ù…Ø³Ù„ÙˆÙ‚ Ù…Ø¹ Ø§Ù„Ø·Ø­ÙŠÙ†Ø©';
            }
            
            return meals;
        }

        function showResults() {
            // Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
            answers.age = parseInt(document.getElementById('age').value);
            answers.currentWeight = parseFloat(document.getElementById('currentWeight').value);
            answers.height = parseInt(document.getElementById('height').value);
            answers.targetWeight = parseFloat(document.getElementById('targetWeight').value);
            answers.gender = document.getElementById('gender').value;
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
            const weightChangeSpeed = document.querySelector('[data-question="1"] .option-card.selected')?.dataset.value || 'moderate';
            const activityLevel = document.querySelector('[data-question="2"] .option-card.selected')?.dataset.value || 'sedentary';
            const dietType = document.querySelector('[data-question="3"] .option-card.selected')?.dataset.value || 'mixed';
            const budget = document.querySelector('[data-question="4"] .option-card.selected')?.dataset.value || 'medium';
            const goal = document.querySelector('[data-question="6"] .option-card.selected')?.dataset.value || 'fitness';
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØµØ­ÙŠØ©
            answers.allergies = [];
            document.querySelectorAll('[data-question="3"] .checkbox-item.selected').forEach(item => {
                if (item.dataset.allergy) {
                    answers.allergies.push(item.dataset.allergy);
                }
            });
            
            answers.healthConditions = [];
            answers.supplements = [];
            document.querySelectorAll('[data-question="5"] .checkbox-item.selected').forEach(item => {
                if (item.dataset.condition) {
                    answers.healthConditions.push(item.dataset.condition);
                }
                if (item.dataset.supplement) {
                    answers.supplements.push(item.dataset.supplement);
                }
            });
            
            // Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
            const bmi = answers.currentWeight / Math.pow(answers.height / 100, 2);
            const bmr = calculateBMR(answers.currentWeight, answers.height, answers.age, answers.gender);
            const tdee = calculateTDEE(bmr, activityLevel);
            const calorieGoal = calculateCalorieGoal(tdee, goal, weightChangeSpeed);
            const macros = calculateMacros(calorieGoal, goal);
            const weightDifference = answers.targetWeight - answers.currentWeight;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            displayResults({
                bmi,
                bmr,
                tdee,
                calorieGoal,
                macros,
                weightDifference,
                goal,
                activityLevel,
                dietType,
                budget
            });
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø®ÙŠØ± ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            document.querySelector(`[data-question="${currentQuestion}"]`).classList.remove('active');
            document.getElementById('results').classList.add('active');
            
            // Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            localStorage.setItem('quizResults', JSON.stringify({
                answers,
                calculations: { bmi, bmr, tdee, calorieGoal, macros, weightDifference }
            }));
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø®Ø§Ø¯Ù…
            sendAnswersToServer();
        }

        function displayResults(results) {
            const resultsContainer = document.getElementById('calculationResults');
            
            // ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ²Ù†
            let bmiStatus = '';
            if (results.bmi < 18.5) bmiStatus = 'Ù†Ù‚Øµ ÙÙŠ Ø§Ù„ÙˆØ²Ù†';
            else if (results.bmi < 25) bmiStatus = 'ÙˆØ²Ù† Ø·Ø¨ÙŠØ¹ÙŠ';
            else if (results.bmi < 30) bmiStatus = 'Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„ÙˆØ²Ù†';
            else bmiStatus = 'Ø³Ù…Ù†Ø©';
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§ØªØ¬Ø§Ù‡ ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ²Ù†
            let weightGoal = '';
            if (results.weightDifference > 0) {
                weightGoal = `Ø²ÙŠØ§Ø¯Ø© ${Math.abs(results.weightDifference).toFixed(1)} ÙƒÙŠÙ„Ùˆ`;
            } else if (results.weightDifference < 0) {
                weightGoal = `Ø¥Ù†Ù‚Ø§Øµ ${Math.abs(results.weightDifference).toFixed(1)} ÙƒÙŠÙ„Ùˆ`;
            } else {
                weightGoal = 'Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ';
            }
            
            resultsContainer.innerHTML = `
                <div class="calculation-grid">
                    <div class="calc-card">
                        <div class="calc-icon">ğŸ“Š</div>
                        <div class="calc-title">Ù…Ø¤Ø´Ø± ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø³Ù…</div>
                        <div class="calc-value">${results.bmi.toFixed(1)}</div>
                        <div class="calc-status">${bmiStatus}</div>
                    </div>
                    
                    <div class="calc-card">
                        <div class="calc-icon">ğŸ”¥</div>
                        <div class="calc-title">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø£ÙŠØ¶ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</div>
                        <div class="calc-value">${Math.round(results.bmr)}</div>
                        <div class="calc-status">Ø³Ø¹Ø±Ø© Ø­Ø±Ø§Ø±ÙŠØ©/ÙŠÙˆÙ…</div>
                    </div>
                    
                    <div class="calc-card">
                        <div class="calc-icon">âš¡</div>
                        <div class="calc-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</div>
                        <div class="calc-value">${Math.round(results.tdee)}</div>
                        <div class="calc-status">Ø³Ø¹Ø±Ø© Ø­Ø±Ø§Ø±ÙŠØ©/ÙŠÙˆÙ…</div>
                    </div>
                    
                    <div class="calc-card">
                        <div class="calc-icon">ğŸ¯</div>
                        <div class="calc-title">Ù‡Ø¯Ù Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</div>
                        <div class="calc-value calories-value">${Math.round(results.calorieGoal)}</div>
                        <div class="calc-status">Ø³Ø¹Ø±Ø© Ø­Ø±Ø§Ø±ÙŠØ©/ÙŠÙˆÙ…</div>
                    </div>
                    
                    <div class="calc-card">
                        <div class="calc-icon">âš–ï¸</div>
                        <div class="calc-title">Ù‡Ø¯Ù Ø§Ù„ÙˆØ²Ù†</div>
                        <div class="calc-value">${answers.targetWeight} ÙƒÙŠÙ„Ùˆ</div>
                        <div class="calc-status">${weightGoal}</div>
                    </div>
                    
                    <div class="calc-card">
                        <div class="calc-icon">ğŸ“…</div>
                        <div class="calc-title">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</div>
                        <div class="calc-value">${Math.ceil(Math.abs(results.weightDifference) * 7 / 0.5)}</div>
                        <div class="calc-status">Ø£Ø³Ø¨ÙˆØ¹ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹</div>
                    </div>
                </div>
            `;
            
            // Ø¹Ø±Ø¶ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø§ÙƒØ±ÙˆØ²
            displayMacroChart(results.macros, results.calorieGoal);
            
            // Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø®Ø·Ø© Ø§Ù„ÙˆØ¬Ø¨Ø§Øª
            displayMealPlan(results);
        }

        function displayMacroChart(macros, totalCalories) {
            const chartContainer = document.getElementById('macroChart');
            
            const proteinPercent = (macros.protein * 4 / totalCalories * 100).toFixed(1);
            const carbsPercent = (macros.carbs * 4 / totalCalories * 100).toFixed(1);
            const fatsPercent = (macros.fats * 9 / totalCalories * 100).toFixed(1);
            
            chartContainer.innerHTML = `
                <h3>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© Ø§Ù„ÙƒØ¨Ø±Ù‰</h3>
                <div class="macro-bars">
                    <div class="macro-bar">
                        <div class="macro-label">Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†</div>
                        <div class="macro-progress">
                            <div class="macro-fill protein" style="width: ${proteinPercent}%"></div>
                        </div>
                        <div class="macro-value protein-value">${macros.protein}g (${proteinPercent}%)</div>
                    </div>
                    
                    <div class="macro-bar">
                        <div class="macro-label">Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª</div>
                        <div class="macro-progress">
                            <div class="macro-fill carbs" style="width: ${carbsPercent}%"></div>
                        </div>
                        <div class="macro-value carbs-value">${macros.carbs}g (${carbsPercent}%)</div>
                    </div>
                    
                    <div class="macro-bar">
                        <div class="macro-label">Ø§Ù„Ø¯Ù‡ÙˆÙ†</div>
                        <div class="macro-progress">
                            <div class="macro-fill fats" style="width: ${fatsPercent}%"></div>
                        </div>
                        <div class="macro-value fats-value">${macros.fats}g (${fatsPercent}%)</div>
                    </div>
                </div>
            `;
        }

        function displayMealPlan(results) {
            const mealPlanContainer = document.getElementById('mealPlanPreview');
            const meals = generateMealPlan(
                results.calorieGoal,
                results.macros,
                results.dietType,
                answers.allergies,
                'middle_eastern',
                results.budget
            );
            
            mealPlanContainer.innerHTML = `
                <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø®Ø·Ø© Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
                <div class="meal-cards">
                    <div class="meal-card">
                        <div class="meal-time">Ø§Ù„Ø¥ÙØ·Ø§Ø±</div>
                        <div class="meal-name">${meals.breakfast.name}</div>
                        <div class="meal-calories">${meals.breakfast.calories} Ø³Ø¹Ø±Ø©</div>
                    </div>
                    
                    <div class="meal-card">
                        <div class="meal-time">ÙˆØ¬Ø¨Ø© Ø®ÙÙŠÙØ©</div>
                        <div class="meal-name">${meals.snack1.name}</div>
                        <div class="meal-calories">${meals.snack1.calories} Ø³Ø¹Ø±Ø©</div>
                    </div>
                    
                    <div class="meal-card">
                        <div class="meal-time">Ø§Ù„ØºØ¯Ø§Ø¡</div>
                        <div class="meal-name">${meals.lunch.name}</div>
                        <div class="meal-calories">${meals.lunch.calories} Ø³Ø¹Ø±Ø©</div>
                    </div>
                    
                    <div class="meal-card">
                        <div class="meal-time">ÙˆØ¬Ø¨Ø© Ø®ÙÙŠÙØ©</div>
                        <div class="meal-name">${meals.snack2.name}</div>
                        <div class="meal-calories">${meals.snack2.calories} Ø³Ø¹Ø±Ø©</div>
                    </div>
                    
                    <div class="meal-card">
                        <div class="meal-time">Ø§Ù„Ø¹Ø´Ø§Ø¡</div>
                        <div class="meal-name">${meals.dinner.name}</div>
                        <div class="meal-calories">${meals.dinner.calories} Ø³Ø¹Ø±Ø©</div>
                    </div>
                </div>
                
                <div class="meal-summary">
                    <div class="summary-item">
                        <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø±Ø§Øª:</span>
                        <span>${Math.round(results.calorieGoal)} Ø³Ø¹Ø±Ø© Ø­Ø±Ø§Ø±ÙŠØ©</span>
                    </div>
                    <div class="summary-item">
                        <span>Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª:</span>
                        <span>5 ÙˆØ¬Ø¨Ø§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹</span>
                    </div>
                    <div class="summary-item">
                        <span>Ù†ÙˆØ¹ Ø§Ù„Ù†Ø¸Ø§Ù…:</span>
                        <span>${results.dietType === 'vegetarian' ? 'Ù†Ø¨Ø§ØªÙŠ' : results.dietType === 'vegan' ? 'Ù†Ø¨Ø§ØªÙŠ ØµØ±Ù' : 'Ù…ØªÙ†ÙˆØ¹'}</span>
                    </div>
                </div>
            `;
        }

        function downloadPlan() {
            const savedResults = localStorage.getItem('quizResults');
            if (!savedResults) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„');
                return;
            }
            
            const data = JSON.parse(savedResults);
            const { answers, calculations } = data;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù
            let content = `Ø®Ø·Ø© Ø§Ù„Ù„ÙŠØ§Ù‚Ø© ÙˆØ§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©\n`;
            content += `=====================================\n\n`;
            
            content += `Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©:\n`;
            content += `Ø§Ù„Ø¹Ù…Ø±: ${answers.age} Ø³Ù†Ø©\n`;
            content += `Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ: ${answers.currentWeight} ÙƒÙŠÙ„Ùˆ\n`;
            content += `Ø§Ù„Ø·ÙˆÙ„: ${answers.height} Ø³Ù…\n`;
            content += `Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù: ${answers.targetWeight} ÙƒÙŠÙ„Ùˆ\n`;
            content += `Ø§Ù„Ø¬Ù†Ø³: ${answers.gender === 'male' ? 'Ø°ÙƒØ±' : 'Ø£Ù†Ø«Ù‰'}\n\n`;
            
            content += `Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª:\n`;
            content += `Ù…Ø¤Ø´Ø± ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø³Ù…: ${calculations.bmi.toFixed(1)}\n`;
            content += `Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø£ÙŠØ¶ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: ${Math.round(calculations.bmr)} Ø³Ø¹Ø±Ø©/ÙŠÙˆÙ…\n`;
            content += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: ${Math.round(calculations.tdee)} Ø³Ø¹Ø±Ø©/ÙŠÙˆÙ…\n`;
            content += `Ù‡Ø¯Ù Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©: ${Math.round(calculations.calorieGoal)} Ø³Ø¹Ø±Ø©/ÙŠÙˆÙ…\n\n`;
            
            content += `ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©:\n`;
            content += `Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†: ${calculations.macros.protein}g\n`;
            content += `Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª: ${calculations.macros.carbs}g\n`;
            content += `Ø§Ù„Ø¯Ù‡ÙˆÙ†: ${calculations.macros.fats}g\n\n`;
            
            content += `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø£Ø¨Ø·Ø§Ù„\n`;
            content += `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-SA')}\n`;
            
            // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ø®Ø·Ø©_Ø§Ù„Ù„ÙŠØ§Ù‚Ø©_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function viewMealPlan() {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const caloriesElement = document.querySelector('#calculationResults .calories-value');
            const proteinElement = document.querySelector('#calculationResults .protein-value');
            const carbsElement = document.querySelector('#calculationResults .carbs-value');
            const fatsElement = document.querySelector('#calculationResults .fats-value');
            const goalElement = document.querySelector('[data-question="6"] .option-card.selected');
            
            const calories = caloriesElement ? caloriesElement.textContent.replace(/[^0-9]/g, '') : 2000;
            const protein = proteinElement ? proteinElement.textContent.replace(/[^0-9]/g, '') : 150;
            const carbs = carbsElement ? carbsElement.textContent.replace(/[^0-9]/g, '') : 200;
            const fats = fatsElement ? fatsElement.textContent.replace(/[^0-9]/g, '') : 70;
            const goal = goalElement ? goalElement.dataset.value : 'maintenance';
            
            // ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø®Ø·Ø© Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const url = `/meal-plan?calories=${calories}&protein=${protein}&carbs=${carbs}&fats=${fats}&goal=${goal}`;
            window.open(url, '_blank');
        }

        function sendAnswersToServer() {
            const allAnswers = {
                ...answers,
                weightChangeSpeed: document.querySelector('[data-question="1"] .option-card.selected')?.dataset.value,
                activityLevel: document.querySelector('[data-question="2"] .option-card.selected')?.dataset.value,
                dietType: document.querySelector('[data-question="3"] .option-card.selected')?.dataset.value,
                budget: document.querySelector('[data-question="4"] .option-card.selected')?.dataset.value,
                goal: document.querySelector('[data-question="6"] .option-card.selected')?.dataset.value
            };
            
            fetch('/quiz-results', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(allAnswers)
            })
            .then(response => response.json())
            .then(data => {
                console.log('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ù†Ø¬Ø§Ø­:', data);
            })
            .catch(error => {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬:', error);
            });
        }
    </script>
</body>
</html>